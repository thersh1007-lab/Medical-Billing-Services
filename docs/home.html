<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Medical Billing Services | California ALW Billing for RCFE &amp; ARF</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
<!-- =========================================================
MEDBILLINGCO.COM — HOMEPAGE (CLEAN / GREEN / FULL-WIDTH) — v3
Single-file paste for GoHighLevel (one Custom Code block)

What this version fixes/improves:
✅ “Left gap” / not-full-width issues: uses a safe full-bleed wrapper (100vw breakout)
✅ Top CTA bar + main header aligned to same max-width grid
✅ Sticky header (optional) + mobile menu
✅ Hero layout matches your screenshot (pill label, big headline, buttons, chips, 4 service cards)
✅ Sections included: Services, Why Different, Checklist (lead magnet), Testimonials, Kam’s Corner, FAQ, Final CTA, Footer

Quick edits (search these):
- BOOKING_LINK
- CHECKLIST_ANCHOR (defaults to #checklist)
- HERO_IMAGE_URL
- LOGO_TEXT (or swap to image)
- Custom Values (optional): business name + phone display

========================================================= -->

<style>
  /* ===================== SCOPE + RESET ===================== */
  .mbs3{
    /* Full-bleed breakout to eliminate “left gap” when GHL wraps content */
    position:relative;
    left:50%;
    right:50%;
    margin-left:-50vw;
    margin-right:-50vw;
    width:100vw;
    max-width:100vw;
    overflow-x:clip;
  }
  .mbs3, .mbs3 *{ box-sizing:border-box; }
  .mbs3 a{ color:inherit; text-decoration:none; }
  .mbs3 img{ max-width:100%; display:block; }

  /* ===================== TOKENS ===================== */
  .mbs3{
    --bg:#f4f7f6;
    --card:#ffffff;
    --heroImg:url("https://images.pexels.com/photos/7651555/pexels-photo-7651555.jpeg");
    --ink:#0b1220;
    --muted:rgba(11,18,32,.68);
    --line:rgba(11,18,32,.10);

    --accent:#168a5b;          /* primary green */
    --accent-2:#0f6e48;        /* darker */
    --pill:rgba(22,138,91,.10);

    --radius-xl:28px;
    --radius-lg:20px;
    --radius-md:14px;

    --shadow:0 18px 50px rgba(11,18,32,.08);
    --shadow-soft:0 10px 30px rgba(11,18,32,.06);

    --max:1180px;
    --pad:24px;
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    color:var(--ink);
    background:
      radial-gradient(900px 420px at 10% 0%, rgba(22,138,91,.14), transparent 60%),
      radial-gradient(700px 360px at 65% 12%, rgba(22,138,91,.10), transparent 55%),
      linear-gradient(#ffffff, var(--bg));
  }

  .mbs3-shell{
    max-width:var(--max);
    margin:0 auto;
    padding:0 var(--pad);
    width:100%;
  }

  /* ===================== TOP CTA BAR ===================== */
  .mbs3-topbar{
    padding:18px 0 10px;
  }
  .mbs3-topbar-inner{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    padding:14px 16px;
    border:1px solid var(--line);
    background:rgba(255,255,255,.65);
    backdrop-filter: blur(10px);
    border-radius:16px;
    box-shadow: var(--shadow-soft);
  }
  .mbs3-topbar-text{
    font-size:15px;
    color:rgba(11,18,32,.72);
    line-height:1.35;
  }
  .mbs3-topbar-text b{ color:var(--ink); font-weight:700; }
  .mbs3-topbar-actions{ display:flex; gap:10px; flex-wrap:wrap; }

  /* ===================== HEADER ===================== */
  .mbs3-header{
    position:sticky; top:0; z-index:50; /* remove if you don’t want sticky */
    background:rgba(244,247,246,.65);
    backdrop-filter: blur(10px);
    border-bottom:1px solid rgba(11,18,32,.06);
  }
  .mbs3-header-inner{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:18px;
    padding:14px 0;
  }

  .mbs3-brand{
    display:flex; align-items:center; gap:12px;
    min-width:240px;
  }
  .mbs3-logo{
    width:38px; height:38px;
    border-radius:12px;
    display:grid; place-items:center;
    background:rgba(22,138,91,.12);
    border:1px solid rgba(22,138,91,.20);
    color:var(--accent);
    font-weight:900;
    letter-spacing:.5px;
  }
  .mbs3-brandtext{
    display:flex; flex-direction:column; gap:2px;
    line-height:1.1;
  }
  .mbs3-brandname{
    font-weight:800; font-size:16px;
  }
  .mbs3-brandsub{
    font-size:13px;
    color:rgba(11,18,32,.62);
  }

  .mbs3-nav{
    display:flex; align-items:center; gap:18px;
    color:rgba(11,18,32,.72);
    font-weight:600;
    font-size:14px;
  }
  .mbs3-nav a{
    padding:10px 10px;
    border-radius:12px;
  }
  .mbs3-nav a:hover{
    background:rgba(255,255,255,.7);
    color:var(--ink);
  }

  .mbs3-header-actions{
    display:flex; align-items:center; gap:12px;
    flex-wrap:wrap;
  }

  .mbs3-phone{
    display:flex; align-items:center; gap:10px;
    padding:10px 14px;
    border:1px solid var(--line);
    background:rgba(255,255,255,.78);
    border-radius:999px;
    font-weight:800;
    color:rgba(11,18,32,.78);
    white-space:nowrap;
  }
  .mbs3-dot{
    width:10px; height:10px; border-radius:99px;
    background:var(--accent);
    box-shadow:0 0 0 6px rgba(22,138,91,.14);
  }

  .mbs3-btn{
    display:inline-flex; align-items:center; justify-content:center;
    gap:10px;
    padding:11px 16px;
    border-radius:999px;
    border:1px solid var(--line);
    background:rgba(255,255,255,.92);
    font-weight:800;
    font-size:14px;
    transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
    cursor:pointer;
    white-space:nowrap;
  }
  .mbs3-btn:hover{ transform: translateY(-1px); box-shadow: var(--shadow-soft); }
  .mbs3-btn--primary{
    background:var(--accent);
    border-color:rgba(22,138,91,.35);
    color:#fff;
  }
  .mbs3-btn--primary:hover{ background:var(--accent-2); }

  /* Mobile menu */
  .mbs3-menu-btn{
    display:none;
    padding:10px 12px;
    border-radius:14px;
  }
  .mbs3-menu-panel{
    display:none;
    padding:10px 0 18px;
  }
  .mbs3-menu-panel a{
    display:block;
    padding:12px 12px;
    border-radius:14px;
    font-weight:800;
    color:rgba(11,18,32,.78);
  }
  .mbs3-menu-panel a:hover{ background:rgba(255,255,255,.75); }

  /* ===================== HERO (full-bleed dark) ===================== */
  .mbs3-hero{
    padding:22px 0 26px;
  }
  .mbs3-hero-card{
    position:relative;
    border-radius:clamp(22px,3vw,34px);
    overflow:hidden;
    box-shadow:var(--shadow);
    background:#0b1220;
  }
  .mbs3-heroBg{
    position:absolute;inset:0;
    background-image:var(--heroImg);
    background-size:cover;
    background-position:center;
    transform:scale(1.02);
    filter:saturate(1.02) contrast(1.02);
  }
  .mbs3-heroOverlay{
    position:absolute;inset:0;
    background:
      radial-gradient(900px 520px at 16% 26%, rgba(255,255,255,.18), rgba(255,255,255,0) 62%),
      linear-gradient(90deg, rgba(11,18,32,.72) 0%, rgba(11,18,32,.38) 58%, rgba(11,18,32,.60) 100%);
  }
  .mbs3-hero-left{
    position:relative;
    padding:clamp(28px,4.2vw,58px);
    max-width:820px;
  }

  .mbs3-pill{
    display:inline-flex;
    align-items:center;
    gap:10px;
    padding:8px 12px;
    border-radius:999px;
    background:rgba(255,255,255,.14);
    border:1px solid rgba(255,255,255,.18);
    color:rgba(255,255,255,.92);
    font-weight:900;
    font-size:13px;
  }
  .mbs3-pill .mbs3-dot{ width:10px; height:10px; box-shadow:none; }

  .mbs3-h1{
    margin:18px 0 10px;
    font-size:clamp(32px,3.6vw,58px);
    line-height:1.04;
    letter-spacing:-1.2px;
    color:#fff;
    text-shadow:0 10px 30px rgba(0,0,0,.25);
  }
  .mbs3-lede{
    margin:0 0 18px;
    font-size:16.5px;
    line-height:1.55;
    color:rgba(255,255,255,.86);
    max-width:620px;
  }

  .mbs3-hero-ctas{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    margin:18px 0 14px;
  }

  .mbs3-chips{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    margin-top:14px;
  }
  .mbs3-chip{
    display:inline-flex;
    align-items:center;
    gap:10px;
    padding:10px 14px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.18);
    background:rgba(255,255,255,.14);
    font-weight:800;
    color:rgba(255,255,255,.92);
    backdrop-filter:blur(10px);
  }
  .mbs3-chip .mbs3-dot{
    width:9px; height:9px;
    background:var(--accent);
    box-shadow:0 0 0 4px rgba(22,138,91,.20);
  }

  /* Service tiles under hero */
  .mbs3-tiles{
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap:18px;
    margin-top:22px;
  }
  .mbs3-tile{
    padding:18px 18px 16px;
    border-radius:18px;
    border:1px solid rgba(11,18,32,.08);
    background:rgba(255,255,255,.78);
    box-shadow:0 10px 30px rgba(11,18,32,.04);
  }
  .mbs3-tile h3{
    margin:0 0 8px;
    font-size:18px;
    letter-spacing:-.2px;
  }
  .mbs3-tile p{
    margin:0 0 14px;
    color:rgba(11,18,32,.62);
    line-height:1.55;
    font-size:14.5px;
  }
  .mbs3-link{
    display:inline-flex; align-items:center; gap:8px;
    font-weight:900;
    color:var(--accent);
  }
  .mbs3-link span{ transform: translateY(1px); }

  /* ===================== SECTIONS ===================== */
  .mbs3-section{
    padding:54px 0;
  }
  .mbs3-section h2{
    font-size:34px;
    letter-spacing:-.6px;
    margin:0 0 12px;
  }
  .mbs3-sub{
    margin:0 0 22px;
    color:rgba(11,18,32,.62);
    line-height:1.6;
    max-width:760px;
  }

  .mbs3-grid-2{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:22px;
    align-items:start;
  }
  .mbs3-card{
    background:rgba(255,255,255,.78);
    border:1px solid rgba(11,18,32,.08);
    border-radius:22px;
    box-shadow:0 16px 40px rgba(11,18,32,.06);
    padding:22px;
  }
  .mbs3-list{
    margin:0; padding-left:18px;
    color:rgba(11,18,32,.68);
    line-height:1.7;
  }
  .mbs3-list li{ margin:8px 0; }

  /* Checklist (lead magnet) */
  .mbs3-checklist{
    display:grid;
    grid-template-columns: 1.05fr .95fr;
    gap:22px;
    align-items:stretch;
  }
  .mbs3-form{
    display:grid;
    gap:10px;
  }
  .mbs3-input{
    width:100%;
    padding:12px 14px;
    border-radius:14px;
    border:1px solid rgba(11,18,32,.14);
    background:rgba(255,255,255,.92);
    font-size:14.5px;
    outline:none;
  }
  .mbs3-input:focus{
    border-color: rgba(22,138,91,.45);
    box-shadow: 0 0 0 6px rgba(22,138,91,.12);
  }
  .mbs3-small{
    font-size:12.5px;
    line-height:1.45;
    color:rgba(11,18,32,.55);
  }

  /* Testimonials */
  .mbs3-quotes{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap:18px;
    margin-top:18px;
  }
  .mbs3-quote{
    padding:18px;
    border-radius:20px;
    border:1px solid rgba(11,18,32,.08);
    background:rgba(255,255,255,.78);
  }
  .mbs3-quote p{
    margin:0 0 10px;
    color:rgba(11,18,32,.70);
    line-height:1.6;
  }
  .mbs3-quote b{ display:block; color:rgba(11,18,32,.82); }

  /* FAQ */
  .mbs3-faq{
    display:grid;
    gap:12px;
    margin-top:18px;
  }
  details.mbs3-faqitem{
    background:rgba(255,255,255,.78);
    border:1px solid rgba(11,18,32,.08);
    border-radius:18px;
    padding:14px 16px;
  }
  details.mbs3-faqitem summary{
    cursor:pointer;
    font-weight:900;
    color:rgba(11,18,32,.82);
    list-style:none;
  }
  details.mbs3-faqitem summary::-webkit-details-marker{ display:none; }
  .mbs3-faqitem .mbs3-faqbody{
    margin-top:10px;
    color:rgba(11,18,32,.66);
    line-height:1.65;
  }

  /* Final CTA */
  .mbs3-final{
    padding:64px 0 72px;
  }
  .mbs3-final-card{
    border-radius:var(--radius-xl);
    padding:34px;
    border:1px solid rgba(22,138,91,.20);
    background:
      radial-gradient(900px 340px at 18% 0%, rgba(22,138,91,.22), transparent 60%),
      rgba(255,255,255,.78);
    box-shadow: var(--shadow);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:18px;
    flex-wrap:wrap;
  }
  .mbs3-final-card h2{ margin:0 0 8px; font-size:30px; }
  .mbs3-final-card p{ margin:0; color:rgba(11,18,32,.66); line-height:1.6; max-width:640px; }

  /* Footer */
  .mbs3-footer{
    padding:22px 0 36px;
    border-top:1px solid rgba(11,18,32,.08);
    color:rgba(11,18,32,.62);
    font-size:13.5px;
  }

  /* ===================== RESPONSIVE ===================== */
  @media (max-width: 980px){
    .mbs3-hero-left{ padding:clamp(24px,3vw,42px); }
    .mbs3-tiles{ grid-template-columns: repeat(2, 1fr); }
    .mbs3-grid-2{ grid-template-columns:1fr; }
    .mbs3-checklist{ grid-template-columns:1fr; }
    .mbs3-quotes{ grid-template-columns:1fr; }
    .mbs3-h1{ font-size:46px; }
    .mbs3-brand{ min-width:auto; }
    .mbs3-nav{ display:none; }
    .mbs3-menu-btn{ display:inline-flex; }
  }
  @media (max-width: 560px){
    .mbs3-hero-left{ padding:30px 22px 22px; }
    .mbs3-h1{ font-size:40px; }
    .mbs3-topbar-inner{ flex-direction:column; align-items:flex-start; }
    .mbs3-tiles{ grid-template-columns:1fr; }
    .mbs3-header-actions{ gap:10px; }
    .mbs3-phone{ display:none; } /* keep header clean on very small screens */
  }

  /* ========= POLISH PACK: ANIMATIONS + ENHANCEMENTS ========= */
  /* Scroll Reveal */
  .reveal{opacity:0;transform:translateY(22px);transition:opacity .55s ease,transform .55s ease}
  .reveal.visible{opacity:1;transform:none}
  .reveal-d1{transition-delay:.1s}.reveal-d2{transition-delay:.2s}.reveal-d3{transition-delay:.3s}

  /* Hero Gradient accent — white on dark hero */
  .heroGradient{ color:#fff; }

  /* Card + tile hover lift */
  @media(hover:hover){
    .mbs3-card,.mbs3-tile,.mbs3-quote{transition:transform .18s ease,box-shadow .18s ease}
    .mbs3-card:hover,.mbs3-tile:hover,.mbs3-quote:hover{
      transform:translateY(-3px);box-shadow:0 24px 60px rgba(11,18,32,.13);
    }
  }

  /* Nav link transition */
  .mbs3-nav a{transition:background .15s ease,color .15s ease}

  /* FAQ chevron + reveal animation */
  details.mbs3-faqitem summary{position:relative;padding-right:28px}
  details.mbs3-faqitem summary::after{
    content:'+';position:absolute;right:4px;top:0;
    transition:transform .2s ease;font-weight:400;opacity:.65;font-size:18px;line-height:1.2;
  }
  details.mbs3-faqitem[open] summary::after{transform:rotate(45deg)}
  details.mbs3-faqitem .mbs3-faqbody{animation:faqReveal .28s ease}
  @keyframes faqReveal{from{opacity:0;transform:translateY(-6px)}to{opacity:1;transform:none}}

  /* Testimonials: stars + role label */
  .mbs3-stars{color:#f59e0b;font-size:14px;letter-spacing:2px;margin-bottom:8px}
  .mbs3-quote-role{display:block;margin-top:4px;font-size:12px;color:rgba(11,18,32,.45);font-weight:600}

  /* Stat Bar */
  .mbs3-statbar{padding:0 0 32px}
  .mbs3-stats{
    display:grid;grid-template-columns:repeat(4,1fr);
    background:rgba(255,255,255,.85);border:1px solid rgba(11,18,32,.08);
    border-radius:20px;box-shadow:0 12px 32px rgba(11,18,32,.06);overflow:hidden;
  }
  .mbs3-stat{
    padding:22px 16px;text-align:center;
    border-right:1px solid rgba(11,18,32,.06);
  }
  .mbs3-stat:last-child{border-right:0}
  .mbs3-stat-num{
    font-size:36px;font-weight:900;letter-spacing:-1.2px;
    color:var(--accent);line-height:1;margin-bottom:6px;
  }
  .mbs3-stat-label{font-size:12.5px;color:rgba(11,18,32,.55);font-weight:700;line-height:1.4}
  @media(max-width:640px){
    .mbs3-stats{grid-template-columns:repeat(2,1fr)}
    .mbs3-stat:nth-child(2){border-right:0}
    .mbs3-stat:nth-child(n+3){border-top:1px solid rgba(11,18,32,.06)}
  }

  /* Kam's Corner */
  .mbs3-kam{display:grid;grid-template-columns:110px 1fr;gap:20px;align-items:center}
  .mbs3-kam-avatar{
    width:110px;height:110px;border-radius:24px;flex:0 0 auto;
    background:linear-gradient(135deg,rgba(22,138,91,.18),rgba(22,138,91,.08));
    border:2px solid rgba(22,138,91,.22);
    display:flex;align-items:center;justify-content:center;
    font-size:34px;font-weight:900;color:var(--accent);
  }
  .mbs3-kam h3{margin:0 0 3px;font-size:19px;letter-spacing:-.3px}
  .mbs3-kam-title{font-size:12.5px;color:rgba(11,18,32,.52);font-weight:700;margin:0 0 10px;display:block}
  .mbs3-kam p{margin:0;color:rgba(11,18,32,.66);line-height:1.7;font-size:14.5px}
  .mbs3-kam-tips{
    display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:16px;
  }
  .mbs3-kam-tip{
    padding:12px 14px;border-radius:14px;border:1px solid rgba(22,138,91,.14);
    background:rgba(22,138,91,.06);font-size:13px;color:rgba(11,18,32,.72);line-height:1.55;
  }
  .mbs3-kam-tip b{display:block;color:var(--accent);font-size:12px;margin-bottom:4px;font-weight:900;text-transform:uppercase;letter-spacing:.5px}
  @media(max-width:760px){.mbs3-kam-tips{grid-template-columns:1fr}}
  @media(max-width:560px){.mbs3-kam{grid-template-columns:1fr;text-align:center}.mbs3-kam-avatar{margin:0 auto}}

  /* ===================== MOBILE OPTIMIZATIONS ===================== */
  /* Tighter shell padding on small phones */
  @media(max-width:480px){
    .mbs3{--pad:16px}
  }
  /* ≤640px core mobile pass */
  @media(max-width:640px){
    .mbs3-topbar{display:none}                    /* sticky CTA replaces this */
    .mbs3-hero-left{padding:24px 20px}
    .mbs3-section{padding:36px 0}
    .mbs3-final{padding:36px 0 52px}
    .mbs3-final-card{flex-direction:column;padding:24px 20px;gap:16px}
    .mbs3-final-card h2{font-size:24px}
    .mbs3-footer{padding-bottom:84px}             /* room for sticky CTA */
  }
  @media(max-width:400px){
    .mbs3-h1{font-size:34px}
    .mbs3-stat-num{font-size:28px}
    .mbs3-stat{padding:16px 10px}
  }

  /* Mobile sticky CTA bar */
  .mbs3-stickyCta{
    display:none;
    position:fixed;left:0;right:0;bottom:0;z-index:80;
    padding:10px 20px 16px;
    background:rgba(255,255,255,.96);
    backdrop-filter:blur(14px);
    border-top:1px solid rgba(11,18,32,.10);
    box-shadow:0 -8px 28px rgba(11,18,32,.10);
  }
  @media(max-width:640px){.mbs3-stickyCta{display:block}}
  .mbs3-stickyCta-inner{display:flex;align-items:center;justify-content:space-between;gap:14px}
  .mbs3-stickyCta-text{font-size:13px;font-weight:700;color:rgba(11,18,32,.68);line-height:1.35}

  /* Wave section dividers */
  .mbs3 .mbs3-wave{height:44px;margin:-14px 0 -18px;pointer-events:none;position:relative;z-index:1}
  .mbs3 .mbs3-wave svg{width:100%;height:100%;display:block}
  .mbs3 .mbs3-wave.toWhite path{fill:#ffffff}
  .mbs3 .mbs3-wave.toSoft path{fill:var(--bg)}
  .mbs3 .mbs3-section--white{background:#ffffff}
  .mbs3 .mbs3-section--soft{background:var(--bg)}

  /* ===================== WIDE NAV HEADER ===================== */
  .mbs3 .wrap{width:min(var(--max),calc(100% - 48px));margin:0 auto}

  .mbs3 .hdr{
    position:sticky;top:0;z-index:50;
    background:rgba(255,255,255,.92);
    backdrop-filter:blur(10px);
    border-bottom:1px solid rgba(11,18,32,.08);
  }
  .mbs3 .nav{
    display:grid;
    grid-template-columns:220px 1fr auto;
    align-items:center;
    gap:16px;
    padding:14px 0;
  }
  .mbs3 .brand{display:flex;align-items:center;gap:10px;min-width:180px}
  .mbs3 .brand img{height:38px;width:auto}

  .mbs3 .menu{
    display:flex;align-items:center;justify-content:center;
    gap:10px;flex-wrap:wrap;
  }
  .mbs3 .menu > a,
  .mbs3 .dd > button{
    padding:10px 10px;border-radius:12px;
    font-size:13px;color:rgba(11,18,32,.78);
    border:0;background:transparent;cursor:pointer;
    font-family:inherit;font-weight:900;
    transition:background .15s ease,color .15s ease;
  }
  .mbs3 .menu > a:hover,
  .mbs3 .dd > button:hover{background:rgba(11,18,32,.05)}
  .mbs3 .active{
    background:rgba(22,138,91,.10);
    border:1px solid rgba(22,138,91,.18);
    color:rgba(11,18,32,.86);
  }

  /* Dropdown */
  .mbs3 .dd{position:relative}
  .mbs3 .dd > button{display:inline-flex;align-items:center;gap:8px}
  .mbs3 .panel{
    position:absolute;top:calc(100% + 10px);left:0;
    min-width:260px;
    background:#fff;
    border:1px solid rgba(11,18,32,.10);
    border-radius:16px;
    box-shadow:0 14px 34px rgba(11,18,32,.10);
    padding:8px;
    display:none;
  }
  .mbs3 .panel a{
    display:flex;gap:10px;align-items:flex-start;
    padding:10px 10px;
    border-radius:12px;
    font-size:13px;
    color:rgba(11,18,32,.82);
    font-weight:900;
  }
  .mbs3 .panel a:hover{background:rgba(11,18,32,.05)}
  .mbs3 .panel .mini{font-size:12px;color:var(--muted);font-weight:600;margin-top:2px}
  .mbs3 .dd:hover .panel{display:block}
  .mbs3 .dd.open .panel{display:block}

  /* Mobile toggle */
  .mbs3 .mToggle{
    display:none;
    justify-self:center;
    padding:10px 12px;border-radius:12px;
    border:1px solid rgba(11,18,32,.12);
    background:#fff;font-weight:900;
    cursor:pointer;
  }

  /* ===================== SITE FOOTER ===================== */
  .mbs3 .site-footer{
    padding:42px 0;
    border-top:1px solid rgba(11,18,32,.08);
    background:#fff;
  }
  .mbs3 .foot{
    display:grid;
    grid-template-columns:1.1fr .9fr .9fr;
    gap:14px;
    align-items:start;
  }
  .mbs3 .foot h4{margin:0 0 10px;font-size:13px;letter-spacing:-.01em}
  .mbs3 .foot a{display:block;padding:8px 0;color:var(--muted);font-size:13.5px}
  .mbs3 .foot a:hover{color:var(--ink)}
  .mbs3 .copy{margin-top:12px;color:var(--muted);font-size:12.5px;line-height:1.6}

  /* Responsive nav + footer */
  @media (max-width:980px){
    .mbs3 .nav{grid-template-columns:1fr auto}
    .mbs3 .menu{
      display:none;
      justify-content:flex-start;
      grid-column:1/-1;
      padding-bottom:10px;
    }
    .mbs3 .menu.open{display:flex}
    .mbs3 .mToggle{display:inline-flex}
  }
  @media (max-width:520px){
    .mbs3 .foot{grid-template-columns:1fr}
  }
</style>

<div class="mbs3" id="top">
  <!-- HEADER -->
  <header class="hdr" role="banner">
    <div class="wrap">
      <div class="nav">
        <a class="brand" href="HOME_LINK" aria-label="Medical Billing Services">
          <img src="https://storage.googleapis.com/msgsndr/mxGAJ81pMGDwP9gcmCOZ/media/6b80e20f-c19b-4897-994e-1ec4194e612d.png" alt="Medical Billing Services Logo">
        </a>

        <button class="mToggle" type="button" aria-controls="primaryNav" aria-expanded="false">Menu</button>

        <nav class="menu" id="primaryNav" aria-label="Primary Navigation">
          <div class="dd" aria-label="State Licensing dropdown">
            <button class="ddBtn" type="button" aria-haspopup="true" aria-expanded="false">
              State Licensing
              <svg viewBox="0 0 24 24" width="12" height="12" fill="none" style="opacity:.8;transform:translateY(1px)">
                <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <div class="panel" role="menu" aria-label="Licensing options">
              <a href="LIC_RCFE_LINK">
                <div>
                  <div>RCFE Licensing</div>
                  <div class="mini">Residential Care Facility for the Elderly</div>
                </div>
              </a>
              <a href="LIC_ARF_LINK">
                <div>
                  <div>ARF Licensing</div>
                  <div class="mini">Adult Residential Facility</div>
                </div>
              </a>
            </div>
          </div>

          <div class="dd" aria-label="ALW Waiver Support dropdown">
            <button class="ddBtn" type="button" aria-haspopup="true" aria-expanded="false">
              ALW Waiver Support
              <svg viewBox="0 0 24 24" width="12" height="12" fill="none" style="opacity:.8;transform:translateY(1px)">
                <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <div class="panel" role="menu" aria-label="ALW Waiver options">
              <a href="BILLING_LINK">
                <div>
                  <div>ALW Billing</div>
                  <div class="mini">End-to-end billing for RCFE &amp; ARF providers</div>
                </div>
              </a>
              <a href="ALW_APP_LINK">
                <div>
                  <div>ALW Application</div>
                  <div class="mini">Waiver application guidance and support</div>
                </div>
              </a>
            </div>
          </div>

          <a href="FUNDING_LINK">ALW Funding/Revenue</a>
          <a href="CONSULTING_LINK">RCFE Consulting</a>
        </nav>

        <!-- Primary CTA -->
        <div style="justify-self:end;display:flex;align-items:center;gap:10px">
          <a class="mbs3-btn mbs3-btn--primary mb-open-consult" href="BOOKING_LINK">Book a Consultation</a>
        </div>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section class="mbs3-hero">
    <div class="mbs3-shell">
      <div class="mbs3-hero-card">
        <div class="mbs3-heroBg" role="img" aria-label="Facility and care image"></div>
        <div class="mbs3-heroOverlay" aria-hidden="true"></div>

        <div class="mbs3-hero-left">
          <div class="mbs3-pill">
            <span class="mbs3-dot" aria-hidden="true"></span>
            Over $1.5 Million Billed Monthly for ARF &amp; RCFE Providers.
          </div>

          <h1 class="mbs3-h1"><span class="heroGradient">ALW</span> Billing &amp; Licensing Support for RCFE + ARF Owners</h1>

          <p class="mbs3-lede">
            If you’re tired of guessing what’s pending, what’s denied, and what’s next,
            we bring structure, proactive follow-through, and operator-level guidance,
            built specifically for the Assisted Living Waiver (ALW) space.
          </p>

          <div class="mbs3-hero-ctas">
            <a class="mbs3-btn mbs3-btn--primary mb-open-consult" href="BOOKING_LINK">Book the right consult</a>
            <a class="mbs3-btn" href="#services">See services</a>
          </div>

          <div class="mbs3-chips" aria-label="Highlights">
            <div class="mbs3-chip"><span class="mbs3-dot" aria-hidden="true"></span> ALW-focused (not generic)</div>
            <div class="mbs3-chip"><span class="mbs3-dot" aria-hidden="true"></span> Proactive follow-through</div>
            <div class="mbs3-chip"><span class="mbs3-dot" aria-hidden="true"></span> Pay-for-performance</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- SERVICE TILES -->
  <section class="mbs3-section mbs3-section--white" id="services" style="padding-top:36px;">
    <div class="mbs3-shell">
      <h2>Choose the path that fits your situation.</h2>
      <p class="mbs3-sub">Pick what you need. We’ll route you to the right next step without confusion.</p>
      <div class="mbs3-tiles">
        <div class="mbs3-tile">
          <h3>ALW Medical Billing</h3>
          <p>Already operating in ALW? We manage billing with structure, proactive follow-up, and clear visibility into what’s happening.</p>
          <a class="mbs3-link" href="BOOKING_LINK">Explore ALW Billing <span>→</span></a>
        </div>

        <div class="mbs3-tile">
          <h3>California Licensing + ALW Applications</h3>
          <p>Starting up or expanding? We guide the state application process and ALW application steps with clear requirements and a clean handoff.</p>
          <a class="mbs3-link" href="BOOKING_LINK">Start Licensing / Application <span>→</span></a>
        </div>

        <div class="mbs3-tile">
          <h3>Revenue Improvement / Additional Funding</h3>
          <p>If you suspect the program can support more, we’ll identify improvement opportunities and map a practical plan for your business.</p>
          <a class="mbs3-link" href="BOOKING_LINK">Explore Revenue Improvement <span>→</span></a>
        </div>

        <div class="mbs3-tile">
          <h3>RCFE Consulting</h3>
          <p>Operator-focused guidance beyond billing. Best practices, documentation readiness, program changes, and smarter decisions as you grow.</p>
          <a class="mbs3-link" href="BOOKING_LINK">Learn More <span>→</span></a>
        </div>
      </div>
    </div>
  </section>

  <!-- STAT BAR -->
  <div class="mbs3-statbar">
    <div class="mbs3-shell">
      <div class="mbs3-stats reveal" id="mbs3-stats">
        <div class="mbs3-stat">
          <div class="mbs3-stat-num" data-count="15" data-suffix="+">15+</div>
          <div class="mbs3-stat-label">Years operator experience</div>
        </div>
        <div class="mbs3-stat">
          <div class="mbs3-stat-num" data-count="200" data-suffix="+">200+</div>
          <div class="mbs3-stat-label">Providers supported</div>
        </div>
        <div class="mbs3-stat">
          <div class="mbs3-stat-num" data-count="22" data-suffix=" days">22 days</div>
          <div class="mbs3-stat-label">Avg. AR days achieved</div>
        </div>
        <div class="mbs3-stat">
          <div class="mbs3-stat-num" data-count="1" data-prefix="$" data-suffix=".5M+">$1.5M+</div>
          <div class="mbs3-stat-label">Billed monthly for providers</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Wave: gradient → white -->
  <div class="mbs3-wave toWhite" aria-hidden="true">
    <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
      <path d="M0,64 C240,0 480,0 720,64 C960,128 1200,128 1440,64 L1440,120 L0,120 Z"></path>
    </svg>
  </div>

  <!-- WHY DIFFERENT -->
  <section class="mbs3-section mbs3-section--white" id="difference">
    <div class="mbs3-shell">
      <h2>Not just billing. Clear execution, plus the guidance owners actually need.</h2>
      <p class=”mbs3-sub”>
        A lot of billing companies are software-first and process-light. They submit claims, collect, and move on.
        We stay engaged. ALW is nuanced, and the difference is often in the follow-through.
      </p>

      <div class=”mbs3-grid-2”>
        <div class=”mbs3-card”>
          <h3 style=”margin:0 0 10px; font-size:18px; letter-spacing:-.2px;”>Structure and proactive follow-through</h3>
          <ul class=”mbs3-list”>
            <li>Visibility into what’s happening (pending, denied, next action).</li>
            <li>Proactive follow-up on issues early, before they cost you weeks.</li>
            <li>Cleaner communication and fewer surprises.</li>
          </ul>
        </div>

        <div class=”mbs3-card”>
          <h3 style=”margin:0 0 10px; font-size:18px; letter-spacing:-.2px;”>Operator-level guidance</h3>
          <ul class=”mbs3-list”>
            <li>Clear requirements: what matters and what doesn’t.</li>
            <li>Documentation readiness, organized the right way.</li>
            <li>A clear path and realistic expectations for your facility.</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- RESOURCES -->
  <section class="mbs3-section mbs3-section--white" id="resources" style="padding-top:0;">
    <div class="mbs3-shell">
      <h2>Resources</h2>
      <p class="mbs3-sub">
        Practical tools you can use today, especially if you’re preparing for ALW, licensing, or a billing clean-up.
      </p>

      <div class="mbs3-grid-2">
        <div class="mbs3-card">
          <h3 style="margin:0 0 10px; font-size:18px;">ALW readiness checklist</h3>
          <p style="margin:0 0 14px; color:rgba(11,18,32,.62); line-height:1.6;">
            The exact items that commonly delay owners, plus what to fix first.
          </p>
          <a class="mbs3-btn mbs3-btn--primary" href="#checklist">Get the checklist</a>
        </div>

        <div class="mbs3-card">
          <h3 style="margin:0 0 10px; font-size:18px;">Book the right consult</h3>
          <p style="margin:0 0 14px; color:rgba(11,18,32,.62); line-height:1.6;">
            Not sure if you need billing help, licensing help, or an ALW plan? We’ll route you fast.
          </p>
          <a class="mbs3-btn mb-open-consult" href="BOOKING_LINK">Book a consult</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Wave: white → soft -->
  <div class="mbs3-wave toSoft" aria-hidden="true">
    <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
      <path d="M0,64 C240,128 480,128 720,64 C960,0 1200,0 1440,64 L1440,120 L0,120 Z"></path>
    </svg>
  </div>

  <!-- CHECKLIST / LEAD MAGNET -->
  <section class="mbs3-section mbs3-section--soft" id="checklist">
    <div class="mbs3-shell">
      <h2>Free ALW readiness checklist</h2>
      <p class="mbs3-sub">
        Get the checklist and the most common “delay fixes” so you can move faster with fewer surprises.
      </p>

      <div class="mbs3-card">
        <div class="mbs3-checklist">
          <div>
            <h3 style="margin:0 0 10px; font-size:18px;">What’s inside</h3>
            <ul class="mbs3-list">
              <li>Document readiness list owners miss (and pay for later)</li>
              <li>Common delay points + how to prevent them</li>
              <li>Clean “next step” roadmap (so you stop guessing)</li>
            </ul>
            <p class="mbs3-small" style="margin-top:14px;">
              Tip: If you’re already mid-process, bring your current status. We’ll help you identify the fastest unblock.
            </p>
          </div>

          <div>
            <!-- Replace this form with your GHL form embed if you want -->
            <form class="mbs3-form" onsubmit="event.preventDefault(); window.location.href='BOOKING_LINK';">
              <input class="mbs3-input" type="text" name="name" placeholder="Your name" required />
              <input class="mbs3-input" type="email" name="email" placeholder="Email address" required />
              <input class="mbs3-input" type="tel" name="phone" placeholder="Phone (optional)" />
              <button class="mbs3-btn mbs3-btn--primary" type="submit">Send me the checklist</button>

              <div class="mbs3-small">
                By submitting, you agree to receive email/SMS updates from {{custom_values.snapshot__business_name}}.
                Reply STOP to unsubscribe. We do not sell your number.
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Wave: soft → white -->
  <div class="mbs3-wave toWhite" aria-hidden="true">
    <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
      <path d="M0,64 C240,0 480,0 720,64 C960,128 1200,128 1440,64 L1440,120 L0,120 Z"></path>
    </svg>
  </div>

  <!-- TESTIMONIALS -->
  <section class="mbs3-section mbs3-section--white">
    <div class="mbs3-shell">
      <h2>Owners choose us for follow-through</h2>
      <p class="mbs3-sub">A calm, structured process so you’re not carrying everything alone.</p>

      <div class=”mbs3-quotes”>
        <div class=”mbs3-quote reveal reveal-d1”>
          <div class=”mbs3-stars”>★★★★★</div>
          <p>”We finally had a clear plan and the process stopped feeling chaotic. Our AR days dropped from 67 to 22.”</p>
          <b>RCFE Administrator</b>
          <span class=”mbs3-quote-role”>32-bed facility, Riverside County</span>
        </div>
        <div class=”mbs3-quote reveal reveal-d2”>
          <div class=”mbs3-stars”>★★★★★</div>
          <p>”The checklist alone saved us weeks of back-and-forth with the state. The sequencing advice was exactly what we needed.”</p>
          <b>ARF Operator</b>
          <span class=”mbs3-quote-role”>Adult Residential Facility, San Bernardino</span>
        </div>
        <div class=”mbs3-quote reveal reveal-d3”>
          <div class=”mbs3-stars”>★★★★★</div>
          <p>“Fast answers, realistic next steps, and real follow-through. Not just a call where someone reads off a checklist.”</p>
          <b>Provider Operator</b>
          <span class=”mbs3-quote-role”>RCFE startup, licensing + ALW track</span>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="mbs3-section mbs3-section--white" id="faq" style="padding-top:0;">
    <div class="mbs3-shell">
      <h2>Frequently asked questions</h2>
      <p class="mbs3-sub">Clear answers, without overwhelming you.</p>

      <div class="mbs3-faq">
        <details class="mbs3-faqitem">
          <summary>Who do you work with?</summary>
          <div class="mbs3-faqbody">
            California RCFE and ARF providers operating in (or preparing for) the ALW ecosystem. Owners and admins who want structured execution and clearer outcomes.
          </div>
        </details>

        <details class="mbs3-faqitem">
          <summary>We already have a biller. Should we still talk?</summary>
          <div class="mbs3-faqbody">
            Yes. If you’re seeing delays, denials, unclear status, or inconsistent follow-through, a short consult can clarify what’s realistic and what to fix first.
          </div>
        </details>

        <details class="mbs3-faqitem">
          <summary>Do you help with state licensing and ALW applications?</summary>
          <div class="mbs3-faqbody">
            Yes. We guide RCFE/ARF licensing steps and ALW application requirements with clear checklists and a clean handoff so you’re not stuck in rework cycles.
          </div>
        </details>

        <details class="mbs3-faqitem">
          <summary>What happens after we pay for an application service?</summary>
          <div class="mbs3-faqbody">
            You’ll get a defined sequence of next steps, what we need from you, expected checkpoints, and clear communication on what’s pending and what’s next.
          </div>
        </details>

        <details class="mbs3-faqitem">
          <summary>How do you handle sensitive documents?</summary>
          <div class="mbs3-faqbody">
            We treat sensitive documents with care, limit access, and use secure workflows for sharing and storage. Specific methods can be explained during your consult based on your situation.
          </div>
        </details>

        <details class="mbs3-faqitem">
          <summary>What’s the best first step?</summary>
          <div class="mbs3-faqbody">
            Book a consultation. We’ll ask a few focused questions, identify your path (billing, licensing/application, revenue improvement, advisory), and outline the cleanest next step.
          </div>
        </details>
      </div>
    </div>
  </section>

  <!-- Wave: white → soft -->
  <div class="mbs3-wave toSoft" aria-hidden="true">
    <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
      <path d="M0,64 C240,128 480,128 720,64 C960,0 1200,0 1440,64 L1440,120 L0,120 Z"></path>
    </svg>
  </div>

  <!-- FINAL CTA -->
  <section class="mbs3-final mbs3-section--soft">
    <div class="mbs3-shell">
      <div class="mbs3-final-card">
        <div>
          <h2>The fastest win is usually clarity.</h2>
          <p>
            What’s happening now, what’s blocking results, and what to do next.
            One conversation can remove the guesswork and set a clear path forward.
          </p>
        </div>
        <div style="display:flex; gap:12px; flex-wrap:wrap;">
          <a class="mbs3-btn" href="#checklist">Get the checklist</a>
          <a class="mbs3-btn mbs3-btn--primary mb-open-consult" href="BOOKING_LINK">Book a consult</a>
        </div>
      </div>
    </div>
  </section>

  <!-- MOBILE STICKY CTA -->
  <div class="mbs3-stickyCta" aria-label="Mobile booking bar">
    <div class="mbs3-stickyCta-inner">
      <div class="mbs3-stickyCta-text">Ready to simplify your<br>ALW process?</div>
      <a class="mbs3-btn mbs3-btn--primary mb-open-consult" href="BOOKING_LINK">Book a consult</a>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="site-footer" role="contentinfo">
    <div class="wrap">
      <div class="foot">
        <div>
          <div class="brand" style="gap:10px">
            <img src="https://storage.googleapis.com/msgsndr/mxGAJ81pMGDwP9gcmCOZ/media/6b80e20f-c19b-4897-994e-1ec4194e612d.png" alt="Medical Billing Services Logo" style="height:34px">
          </div>
          <div class="copy">
            © <span id="mbs3-year"></span> Medical Billing Services. All rights reserved.
            <br>RCFE / ARF • Assisted Living Waiver (ALW)
          </div>
        </div>

        <div>
          <h4>Services</h4>
          <a href="#services">Our Services</a>
          <a href="#faq">FAQs</a>
          <a href="#checklist">Checklist</a>
        </div>

        <div>
          <h4>Support</h4>
          <a href="#" class="mb-open-consult">Book a Consultation</a>
          <a href="BILLING_LINK">ALW Billing</a>
          <a href="CONSULTING_LINK">RCFE Consulting</a>
        </div>
      </div>
    </div>
  </footer>
</div>

<script>
  (function(){
    // ====== QUICK EDITS (set once) ======
    var BOOKING = "https://api.leadconnectorhq.com/widget/bookings/billing-strategy-call"; // BOOKING_LINK
    var HERO_IMAGE = "https://images.pexels.com/photos/7651555/pexels-photo-7651555.jpeg"; // HERO_IMAGE_URL

    // Nav link replacements
    var navLinks = {
      "HOME_LINK": "./home.html",
      "BILLING_LINK": "./alw-billing.html",
      "LIC_RCFE_LINK": "./rcfe-licensing.html",
      "LIC_ARF_LINK": "./arf-licensing.html",
      "ALW_APP_LINK": "./alw-waiver.html",
      "FUNDING_LINK": "./funding.html",
      "CONSULTING_LINK": "./consulting.html"
    };

    // Replace BOOKING_LINK placeholders
    document.querySelectorAll('.mbs3 a[href="BOOKING_LINK"]').forEach(function(a){ a.href = BOOKING; });

    // Replace nav link placeholders
    var root = document.querySelector('.mbs3');
    if(root){
      root.querySelectorAll('a[href]').forEach(function(el){
        var v = el.getAttribute('href');
        if(v && navLinks[v]) el.setAttribute('href', navLinks[v]);
      });
    }

    // Hero image now uses CSS background (--heroImg variable)

    // Mobile nav toggle
    var toggle = root && root.querySelector('.mToggle');
    var nav = root && root.querySelector('#primaryNav');
    if(toggle && nav){
      toggle.addEventListener('click', function(){
        var open = nav.classList.toggle('open');
        toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
      });
    }

    // Dropdown click support (mobile + desktop)
    if(root){
      root.querySelectorAll('.dd .ddBtn').forEach(function(btn){
        btn.addEventListener('click', function(e){
          e.preventDefault();
          var dd = btn.closest('.dd');
          var isOpen = dd.classList.toggle('open');
          btn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
        });
      });
    }

    // Year
    var y = document.getElementById('mbs3-year');
    if(y){ y.textContent = new Date().getFullYear(); }

    // Smooth scroll for in-page anchors
    document.querySelectorAll('.mbs3 a[href^="#"]').forEach(function(a){
      a.addEventListener('click', function(e){
        var id = a.getAttribute('href');
        if(!id || id.length < 2) return;
        var el = document.querySelector(id);
        if(!el) return;
        e.preventDefault();
        el.scrollIntoView({behavior:'smooth', block:'start'});
      });
    });

    // === SCROLL REVEAL ===
    (function(){
      var els = document.querySelectorAll('.mbs3-card, .mbs3-tile, .mbs3-quote, .mbs3-faqitem, .mbs3-section h2, .mbs3-final-card, .mbs3-stats');
      els.forEach(function(el){ if(!el.classList.contains('reveal')) el.classList.add('reveal'); });
      var obs = new IntersectionObserver(function(entries, ob){
        entries.forEach(function(e){
          if(e.isIntersecting){ e.target.classList.add('visible'); ob.unobserve(e.target); }
        });
      }, {threshold:0.10});
      document.querySelectorAll('.reveal').forEach(function(el){ obs.observe(el); });
    })();

    // === COUNT-UP ANIMATION ===
    (function(){
      var statsEl = document.getElementById('mbs3-stats');
      if(!statsEl) return;
      var fired = false;
      function runCountUp(){
        if(fired) return; fired = true;
        statsEl.querySelectorAll('.mbs3-stat-num[data-count]').forEach(function(el){
          var end = parseFloat(el.getAttribute('data-count'));
          var prefix = el.getAttribute('data-prefix') || '';
          var suffix = el.getAttribute('data-suffix') || '';
          var duration = 1000;
          var startTime = null;
          function animate(ts){
            if(!startTime) startTime = ts;
            var progress = Math.min((ts - startTime) / duration, 1);
            var eased = 1 - Math.pow(1 - progress, 3);
            var current = Math.round(eased * end);
            // Special case for $1.5M+
            if(prefix === '$' && suffix === '.5M+'){
              el.textContent = (progress >= 1) ? '$1.5M+' : '$' + current;
            } else {
              el.textContent = prefix + current + suffix;
            }
            if(progress < 1) requestAnimationFrame(animate);
          }
          requestAnimationFrame(animate);
        });
      }
      var obs = new IntersectionObserver(function(entries){
        entries.forEach(function(e){ if(e.isIntersecting) runCountUp(); });
      }, {threshold:0.3});
      obs.observe(statsEl);
    })();
  })();
</script>

<!-- =========================================================
CONSULT MODAL (4-STEP)
========================================================= -->
<style>
  :root{
    --mb-ink:#0b1220;
    --mb-muted:#5b667a;
    --mb-bg: rgba(11,18,32,.55);
    --mb-card:#ffffff;
    --mb-line: rgba(11,18,32,.10);
    --mb-accent:#16a34a;
    --mb-accent2:#0ea5a4;
    --mb-soft:#f3f7f5;
    --mb-danger:#b91c1c;
    --mb-radius:18px;
    --mb-shadow: 0 30px 80px rgba(0,0,0,.35);
    --mb-font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  }

  .mb-modal{ position:fixed; inset:0; display:none; z-index:999999; font-family: var(--mb-font); }
  .mb-modal.is-open{ display:block; }
  .mb-modal__backdrop{ position:absolute; inset:0; background: var(--mb-bg); backdrop-filter: blur(10px); }

  .mb-modal__dialog{
    position:relative;
    width: min(1180px, calc(100% - 24px));
    margin: clamp(12px, 2.5vh, 24px) auto;
    background: var(--mb-card);
    border-radius: var(--mb-radius);
    box-shadow: var(--mb-shadow);
    overflow:hidden;
  }

  .mb-modal__top{
    display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
    padding: 18px 18px 14px 18px;
    border-bottom:1px solid var(--mb-line);
    background:
      radial-gradient(1200px 240px at 10% 0%, rgba(22,163,74,.10), transparent 60%),
      radial-gradient(900px 220px at 90% 0%, rgba(14,165,164,.10), transparent 55%),
      linear-gradient(#fff, #fff);
  }

  .mb-modal__headline{ display:flex; flex-direction:column; gap:6px; padding-right:10px; }
  #mbConsultModal{ font-size: 16px; }

  .mb-modal__title{
    margin:0;
    font-size: clamp(22px, 2.2vw, 30px);
    line-height: 1.12;
    letter-spacing: -0.2px;
    color: var(--mb-ink);
    font-weight: 760;
  }
  .mb-modal__sub{
    margin:0;
    font-size: 16px;
    color: var(--mb-muted);
    line-height:1.45;
    max-width: 70ch;
  }

  .mb-modal__close{
    border:1px solid rgba(11,18,32,.14);
    background:#fff;
    width: 42px; height: 42px;
    border-radius: 12px;
    cursor:pointer;
    display:grid; place-items:center;
    transition: transform .12s ease, background .12s ease;
  }
  .mb-modal__close:hover{ background: rgba(11,18,32,.03); transform: translateY(-1px); }
  .mb-x{ width:18px; height:18px; }

  .mb-modal__body{
    display:grid;
    grid-template-columns: 1.05fr .95fr;
    gap: 0;
    min-height: 680px;
  }
  @media (max-width: 860px){
    .mb-modal__body{ grid-template-columns: 1fr; min-height: unset; }
  }

  .mb-form{ padding: 18px; }

  .mb-steps{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    margin: 4px 0 14px 0;
  }
  .mb-step{
    flex:1;
    display:flex; align-items:center; gap:10px;
    padding: 12px 14px;
    border:1px solid var(--mb-line);
    border-radius: 14px;
    background:#fff;
  }
  .mb-step__dot{
    width:30px; height:30px; border-radius:999px;
    display:grid; place-items:center;
    font-weight:750; font-size: 14px;
    color: var(--mb-muted);
    border:1px solid rgba(11,18,32,.14);
    background:#fff;
  }
  .mb-step.is-active .mb-step__dot{
    color:#fff; border-color: transparent;
    background: linear-gradient(135deg, var(--mb-accent), var(--mb-accent2));
  }
  .mb-step.is-done .mb-step__dot{
    color:#fff; border-color: transparent;
    background: linear-gradient(135deg, var(--mb-accent), var(--mb-accent));
  }
  .mb-step__label{ display:flex; flex-direction:column; line-height:1.1; }
  .mb-step__label b{ font-size: 15px; color: var(--mb-ink); font-weight: 760; }
  .mb-step__label span{ font-size: 14px; color: var(--mb-muted); }

  .mb-grid{ display:grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-top: 14px; }
  @media (max-width: 520px){ .mb-grid{ grid-template-columns: 1fr; } }

  .mb-field{ display:flex; flex-direction:column; gap:7px; }
  .mb-label{ font-size: 14.5px; color: var(--mb-ink); font-weight: 700; }
  .mb-label small{ font-weight: 650; color: var(--mb-muted); }

  .mb-input, .mb-select{
    width:100%;
    border:1px solid rgba(11,18,32,.14);
    border-radius: 14px;
    padding: 14px 14px;
    font-size: 16px;
    outline:none;
    transition: box-shadow .12s ease, border-color .12s ease;
    background:#fff;
  }
  .mb-input:focus, .mb-select:focus{
    border-color: rgba(22,163,74,.55);
    box-shadow: 0 0 0 4px rgba(22,163,74,.12);
  }

  .mb-help{ margin-top: 10px; font-size: 15.5px; color: var(--mb-muted); line-height:1.5; }

  .mb-error{
    display:none;
    margin-top: 10px;
    padding: 10px 12px;
    border-radius: 12px;
    border:1px solid rgba(185,28,28,.25);
    background: rgba(185,28,28,.06);
    color: #7a0f0f;
    font-size: 15px;
    line-height:1.35;
  }
  .mb-error.is-show{ display:block; }

  .mb-actions{
    display:flex; justify-content:space-between; align-items:center; gap: 10px;
    margin-top: 16px;
    padding-top: 14px;
    border-top: 1px solid var(--mb-line);
  }

  .mb-btn{
    border-radius: 999px;
    padding: 13px 16px;
    font-weight: 760;
    font-size: 16px;
    border: 1px solid rgba(11,18,32,.14);
    background: #fff;
    cursor:pointer;
    transition: transform .12s ease, filter .12s ease, background .12s ease;
    display:inline-flex; align-items:center; gap:.55rem;
  }
  .mb-btn:hover{ transform: translateY(-1px); filter: brightness(1.02); }
  .mb-btn--primary{
    border-color: transparent;
    color:#fff;
    background: linear-gradient(135deg, var(--mb-accent), var(--mb-accent2));
  }
  .mb-btn--ghost{ background: rgba(11,18,32,.02); }
  .mb-btn[disabled]{ opacity:.55; cursor:not-allowed; transform:none; }

  .mb-side{
    border-left: 1px solid var(--mb-line);
    background:
      radial-gradient(900px 260px at 90% 0%, rgba(22,163,74,.08), transparent 55%),
      radial-gradient(900px 260px at 20% 40%, rgba(14,165,164,.08), transparent 55%),
      linear-gradient(#fff, #fff);
    padding: 18px;
  }
  @media (max-width: 860px){
    .mb-side{ border-left:none; border-top:1px solid var(--mb-line); }
  }

  .mb-side__card{
    border:1px solid var(--mb-line);
    background:#fff;
    border-radius: 16px;
    padding: 16px;
  }
  .mb-side__kicker{
    font-size: 12px;
    font-weight: 850;
    letter-spacing: .14em;
    text-transform: uppercase;
    color: var(--mb-muted);
    margin: 0 0 8px 0;
  }
  .mb-side__h{
    margin: 0 0 8px 0;
    font-size: clamp(20px, 1.6vw, 24px);
    font-weight: 800;
    color: var(--mb-ink);
    letter-spacing: -.2px;
    line-height: 1.22;
  }
  .mb-side__p{ margin:0; font-size: 15.5px; color: var(--mb-muted); line-height:1.55; }
  .mb-bullets{ margin: 12px 0 0 0; padding: 0 0 0 18px; color: var(--mb-muted); font-size: 15.5px; line-height:1.55; }
  .mb-bullets li{ margin: 8px 0; }

  .mb-calendarWrap{
    margin-top: 14px;
    border:1px solid var(--mb-line);
    border-radius: 16px;
    overflow:hidden;
    background:#fff;
    display:none;
  }
  .mb-calendarTitle{
    padding: 10px 12px;
    border-bottom:1px solid var(--mb-line);
    font-size: 14px;
    font-weight: 800;
    color: var(--mb-ink);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .mb-calendarHint{ font-size: 13px; font-weight: 650; color: var(--mb-muted); }

  .mb-iframe{ width:100%; height: 520px; border:0; display:block; background:#fff; }
  @media (max-width: 520px){ .mb-iframe{ height: 620px; } }

  .mb-pane{ display:none; }
  .mb-pane.is-show{ display:block; }

  .mb-legal{ margin-top: 10px; font-size: 13px; color: rgba(91,102,122,.92); line-height:1.4; }

  .mb-checks{
    grid-column: 1 / -1;
    border: 1px solid var(--mb-line);
    background: rgba(11,18,32,.015);
    border-radius: 14px;
    padding: 14px;
    display:grid;
    gap:12px;
  }
  .mb-check{
    display:flex;
    align-items:flex-start;
    gap:10px;
    font-size: 15.5px;
    color: var(--mb-ink);
    line-height:1.35;
  }
  .mb-check input{
    margin-top: 4px;
    width: 18px; height: 18px;
    accent-color: var(--mb-accent);
  }
  .mb-check span{
    color: var(--mb-muted);
    font-size: 14.5px;
    display:block;
    margin-top: 2px;
    line-height: 1.4;
  }

  .mb-choiceGrid{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 14px;
  }
  @media (max-width: 520px){ .mb-choiceGrid{ grid-template-columns: 1fr; } }

  .mb-choice{
    border:1px solid rgba(11,18,32,.14);
    background:#fff;
    border-radius: 16px;
    padding: 14px;
    cursor:pointer;
    transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .mb-choice:hover{ transform: translateY(-1px); box-shadow: 0 10px 24px rgba(0,0,0,.08); }
  .mb-choice.is-selected{
    border-color: rgba(22,163,74,.65);
    box-shadow: 0 0 0 4px rgba(22,163,74,.12);
  }
  .mb-choice b{ color: var(--mb-ink); font-weight: 820; font-size: 16px; letter-spacing:-.15px; }
  .mb-choice p{ margin:0; color: var(--mb-muted); font-size: 15px; line-height:1.45; }
</style>

<div class="mb-modal" id="mbConsultModal" aria-hidden="true">
  <div class="mb-modal__backdrop" data-mb-close></div>

  <div class="mb-modal__dialog" role="dialog" aria-modal="true" aria-label="Request a consult">
    <div class="mb-modal__top">
      <div class="mb-modal__headline">
        <h2 class="mb-modal__title">Set Up Your Consult</h2>
        <p class="mb-modal__sub">Answer a few quick questions, then choose the consult you'd like to schedule. (California facilities only.)</p>
      </div>

      <button class="mb-modal__close" type="button" aria-label="Close" data-mb-close>
        <svg class="mb-x" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="2.4" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <div class="mb-modal__body">
      <!-- LEFT -->
      <div class="mb-form">
        <div class="mb-steps" aria-label="Steps">
          <div class="mb-step is-active" data-step-ind="1">
            <div class="mb-step__dot">1</div>
            <div class="mb-step__label"><b>Details</b><span>Contact</span></div>
          </div>
          <div class="mb-step" data-step-ind="2">
            <div class="mb-step__dot">2</div>
            <div class="mb-step__label"><b>Facility</b><span>Quick fit</span></div>
          </div>
          <div class="mb-step" data-step-ind="3">
            <div class="mb-step__dot">3</div>
            <div class="mb-step__label"><b>Consult</b><span>Select</span></div>
          </div>
          <div class="mb-step" data-step-ind="4">
            <div class="mb-step__dot">4</div>
            <div class="mb-step__label"><b>Schedule</b><span>Book</span></div>
          </div>
        </div>

        <div class="mb-error" id="mbErr"></div>

        <!-- STEP 1 -->
        <div class="mb-pane is-show" data-step="1">
          <div class="mb-grid">
            <div class="mb-field">
              <label class="mb-label" for="mbFirst">First name <small>(required)</small></label>
              <input class="mb-input" id="mbFirst" type="text" autocomplete="given-name" required />
            </div>
            <div class="mb-field">
              <label class="mb-label" for="mbLast">Last name <small>(required)</small></label>
              <input class="mb-input" id="mbLast" type="text" autocomplete="family-name" required />
            </div>

            <div class="mb-field" style="grid-column:1/-1;">
              <label class="mb-label" for="mbFacility">Facility / business name <small>(if applicable)</small></label>
              <input class="mb-input" id="mbFacility" type="text" autocomplete="organization" />
            </div>

            <div class="mb-field">
              <label class="mb-label" for="mbEmail">Email <small>(required)</small></label>
              <input class="mb-input" id="mbEmail" type="email" autocomplete="email" required />
            </div>
            <div class="mb-field">
              <label class="mb-label" for="mbPhone">Phone <small>(required)</small></label>
              <input class="mb-input" id="mbPhone" type="tel" inputmode="tel" autocomplete="tel" required />
            </div>
          </div>

          <p class="mb-help">Next, we'll confirm a few details to route your consult.</p>

          <div class="mb-actions">
            <button class="mb-btn mb-btn--ghost" type="button" data-mb-close>Not now</button>
            <button class="mb-btn mb-btn--primary" type="button" id="mbNext1">Continue</button>
          </div>

          <div class="mb-legal">By continuing, you agree to be contacted about your consultation request. (No spam.)</div>
        </div>

        <!-- STEP 2 -->
        <div class="mb-pane" data-step="2">
          <div class="mb-grid">
            <div class="mb-field" style="grid-column:1/-1;">
              <label class="mb-label" for="mbZip">Facility Zip Code <small>(required)</small></label>
              <input class="mb-input" id="mbZip" type="text" inputmode="numeric" pattern="\d{5}" placeholder="e.g., 90210" required />
            </div>

            <div class="mb-field">
              <label class="mb-label" for="mbBeds">How many beds? <small>(required)</small></label>
              <select class="mb-select" id="mbBeds" required>
                <option value="" selected disabled>Select…</option>
                <option value="1-10">1–10 beds</option>
                <option value="11-25">11–25 beds</option>
                <option value="26+">26+ beds</option>
              </select>
            </div>

            <div class="mb-field">
              <label class="mb-label" for="mbYears">Years in business <small>(required)</small></label>
              <select class="mb-select" id="mbYears" required>
                <option value="" selected disabled>Select…</option>
                <option value="New (0-1)">New business (0–1 years)</option>
                <option value="1-2">1–2 years</option>
                <option value="3-5">3–5 years</option>
                <option value="6+">6+ years</option>
              </select>
            </div>

            <div class="mb-checks">
              <label class="mb-check">
                <input type="checkbox" id="mbAlw" />
                <div>
                  <div><strong>Currently on the ALW waiver?</strong></div>
                  <span>Check if your facility is actively participating in ALW.</span>
                </div>
              </label>

              <label class="mb-check">
                <input type="checkbox" id="mbRcfe" />
                <div>
                  <div><strong>Currently licensed as RCFE?</strong></div>
                  <span>Check if you already hold an active RCFE license.</span>
                </div>
              </label>

              <label class="mb-check">
                <input type="checkbox" id="mbArf" />
                <div>
                  <div><strong>Currently licensed as ARF?</strong></div>
                  <span>Check if you already hold an active ARF license.</span>
                </div>
              </label>

              <label class="mb-check">
                <input type="checkbox" id="mbLookingToOpen" />
                <div>
                  <div><strong>Looking to open a new facility?</strong></div>
                  <span>Check if you're planning to start a new RCFE or ARF.</span>
                </div>
              </label>

              <label class="mb-check">
                <input type="checkbox" id="mbSettingUpRcfe" />
                <div>
                  <div><strong>Setting up RCFE?</strong></div>
                  <span>Check if you're currently in the process of setting up an RCFE.</span>
                </div>
              </label>
            </div>
          </div>

          <p class="mb-help">If your Zip is outside California, we'll stop scheduling in the next step.</p>

          <div class="mb-actions">
            <button class="mb-btn" type="button" id="mbBack2">Back</button>
            <button class="mb-btn mb-btn--primary" type="button" id="mbNext2">Continue</button>
          </div>
        </div>

        <!-- STEP 3 -->
        <div class="mb-pane" data-step="3">
          <p class="mb-help" style="margin-top:0;">
            What kind of consult would you like to schedule? Choose one option below.
          </p>

          <div class="mb-choiceGrid" id="mbChoices"></div>

          <div class="mb-actions">
            <button class="mb-btn" type="button" id="mbBack3">Back</button>
            <button class="mb-btn mb-btn--primary" type="button" id="mbNext3" disabled>Continue to scheduling</button>
          </div>
        </div>

        <!-- STEP 4 -->
        <div class="mb-pane" data-step="4">
          <p class="mb-help" style="margin-top:0;">
            Schedule your selected consult below. You'll receive confirmation after booking.
          </p>

          <div class="mb-actions">
            <button class="mb-btn" type="button" id="mbBack4">Back</button>
            <button class="mb-btn mb-btn--primary" type="button" id="mbDone">Close</button>
          </div>
        </div>
      </div>

      <!-- RIGHT -->
      <div class="mb-side">
        <div class="mb-side__card">
          <p class="mb-side__kicker">Consultation</p>
          <h3 class="mb-side__h">Pick the right consult in under 60 seconds</h3>
          <p class="mb-side__p">We'll capture basic facility info, then route you to the correct scheduling option.</p>
          <ul class="mb-bullets">
            <li>Quick fit screening (California facilities)</li>
            <li>Choose the consult you actually need</li>
            <li>Clear next steps after booking</li>
          </ul>
        </div>

        <div class="mb-calendarWrap" id="mbCalendarWrap">
          <div class="mb-calendarTitle">
            <span id="mbCalendarTitleText">Schedule your consult</span>
            <span class="mb-calendarHint">Step 4</span>
          </div>
          <iframe class="mb-iframe" id="mbCalendar" src="about:blank" loading="lazy" title="Book a consult"></iframe>
        </div>

        <div class="mb-side__card" id="mbCAOnlyCard" style="margin-top:14px;">
          <p class="mb-side__kicker">Eligibility</p>
          <h3 class="mb-side__h">California facilities only</h3>
          <p class="mb-side__p">We verify your Zip in Step 2. If you're outside CA, scheduling will be blocked.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
(() => {
  const WEBHOOK_URL = "https://services.leadconnectorhq.com/hooks/mxGAJ81pMGDwP9gcmCOZ/webhook-trigger/261d9566-f352-458f-9ecd-60a8d187ba52";

  const CONSULT_OPTIONS = [
    {
      key: "licensing_consultation",
      label: "Licensing Consultation",
      desc: "Guidance for licensing, startup, and compliance steps.",
      calendarUrl: "https://api.leadconnectorhq.com/widget/booking/H3K9LIzRf7zxAwtfyrdN",
      tag: "consult: licensing consultation"
    },
    {
      key: "alw_waiver_consultation",
      label: "ALW Waiver Consultation",
      desc: "Help with ALW waiver program application and requirements.",
      calendarUrl: "https://api.leadconnectorhq.com/widget/booking/xJc3bSlX9mhoNwFsONye",
      tag: "consult: alw waiver consultation"
    },
    {
      key: "billing_strategy_consult",
      label: "Billing Strategy Consult",
      desc: "Billing workflow review and revenue optimization discussion.",
      calendarUrl: "https://api.leadconnectorhq.com/widget/booking/GCyM1GS3QXkgVDFllYMu",
      tag: "consult: billing strategy"
    },
    {
      key: "new_facility_consult",
      label: "New RCFE Consulting",
      desc: "For those looking to start a new RCFE or ARF. We'll walk through the steps to get licensed and operating.",
      calendarUrl: "https://api.leadconnectorhq.com/widget/booking/X33A2JTTT3wOSCed356R",
      tag: "consult: consultation with kamil"
    },
    {
      key: "additional_consult_5",
      label: "Funding / Revenue Expansion Consult",
      desc: "Additional funding and expansion strategy.",
      calendarUrl: "CALENDAR_URL_5_PLACEHOLDER",
      tag: "consult: funding revenue expansion"
    }
  ];

  const TAGS = {
    step1: "step one complete",
    step2: "step two complete",
    step3: "step three complete",
    step4: "step four viewed",
    booked: "appointment booked"
  };

  function isCaliforniaZip(zip){
    const z = String(zip || "").trim();
    if(!/^\d{5}$/.test(z)) return false;
    const n = parseInt(z, 10);
    return (n >= 90001 && n <= 96162);
  }

  const modal = document.getElementById("mbConsultModal");
  const errBox = document.getElementById("mbErr");

  const panes = {
    1: modal.querySelector('[data-step="1"]'),
    2: modal.querySelector('[data-step="2"]'),
    3: modal.querySelector('[data-step="3"]'),
    4: modal.querySelector('[data-step="4"]')
  };

  const stepInd = {
    1: modal.querySelector('[data-step-ind="1"]'),
    2: modal.querySelector('[data-step-ind="2"]'),
    3: modal.querySelector('[data-step-ind="3"]'),
    4: modal.querySelector('[data-step-ind="4"]')
  };

  const calendarWrap = document.getElementById("mbCalendarWrap");
  const calendarFrame = document.getElementById("mbCalendar");
  const calendarTitleText = document.getElementById("mbCalendarTitleText");

  const choicesWrap = document.getElementById("mbChoices");
  const btnNext3 = document.getElementById("mbNext3");

  const f = {
    first: document.getElementById("mbFirst"),
    last: document.getElementById("mbLast"),
    facility: document.getElementById("mbFacility"),
    email: document.getElementById("mbEmail"),
    phone: document.getElementById("mbPhone"),
    zip: document.getElementById("mbZip"),
    beds: document.getElementById("mbBeds"),
    years: document.getElementById("mbYears"),
    alw: document.getElementById("mbAlw"),
    rcfe: document.getElementById("mbRcfe"),
    arf: document.getElementById("mbArf"),
    lookingToOpen: document.getElementById("mbLookingToOpen"),
    settingUpRcfe: document.getElementById("mbSettingUpRcfe"),
  };

  const btnNext1 = document.getElementById("mbNext1");
  const btnNext2 = document.getElementById("mbNext2");
  const btnBack2 = document.getElementById("mbBack2");
  const btnBack3 = document.getElementById("mbBack3");
  const btnBack4 = document.getElementById("mbBack4");
  const btnDone  = document.getElementById("mbDone");

  let selectedConsult = null;

  function showError(msg){
    errBox.textContent = msg;
    errBox.classList.add("is-show");
  }
  function clearError(){
    errBox.textContent = "";
    errBox.classList.remove("is-show");
  }

  function setStep(n){
    clearError();
    Object.keys(panes).forEach(k => panes[k].classList.remove("is-show"));
    panes[n].classList.add("is-show");

    [1,2,3,4].forEach(i => {
      stepInd[i].classList.remove("is-active");
      if(i < n) stepInd[i].classList.add("is-done");
      else stepInd[i].classList.remove("is-done");
    });
    stepInd[n].classList.add("is-active");

    calendarWrap.style.display = (n === 4) ? "block" : "none";
  }

  function normalizeZip(){
    const digits = (f.zip.value || "").replace(/\D/g, "").slice(0,5);
    f.zip.value = digits;
  }

  function isValidEmail(email){
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(email || "").trim());
  }

  function requiredFilledStep1(){
    return (f.first.value||"").trim() && (f.last.value||"").trim() && (f.facility.value||"").trim() && (f.email.value||"").trim() && (f.phone.value||"").trim();
  }

  function requiredFilledStep2(){
    return (f.zip.value||"").trim() && (f.beds.value||"").trim() && (f.years.value||"").trim();
  }

  function getPayload(extra = {}){
    return {
      source: "medbillingco.com consult modal",
      page_url: window.location.href,
      timestamp: new Date().toISOString(),
      contact: {
        first_name: (f.first.value||"").trim(),
        last_name: (f.last.value||"").trim(),
        facility_name: (f.facility.value||"").trim(),
        email: (f.email.value||"").trim(),
        phone: (f.phone.value||"").trim(),
      },
      facility: {
        zip: (f.zip.value||"").trim(),
        beds: (f.beds.value||"").trim(),
        years_in_business: (f.years.value||"").trim(),
        is_ca_zip: isCaliforniaZip((f.zip.value||"").trim()),
        currently_on_alw_waiver: !!(f.alw && f.alw.checked),
        licensed_rcfe: !!(f.rcfe && f.rcfe.checked),
        licensed_arf: !!(f.arf && f.arf.checked),
        looking_to_open: !!(f.lookingToOpen && f.lookingToOpen.checked),
        setting_up_rcfe: !!(f.settingUpRcfe && f.settingUpRcfe.checked)
      },
      consult_selection: selectedConsult ? {
        key: selectedConsult.key,
        label: selectedConsult.label,
        calendar_url: selectedConsult.calendarUrl,
        tag: selectedConsult.tag
      } : null,
      ...extra
    };
  }

  async function postWebhook(payload){
    if(!WEBHOOK_URL) return;
    try{ await fetch(WEBHOOK_URL, { method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify(payload) }); }catch(e){}
  }

  function openModal(){
    modal.classList.add("is-open");
    modal.setAttribute("aria-hidden","false");
    document.body.style.overflow = "hidden";
    selectedConsult = null;
    btnNext3.disabled = true;
    setStep(1);
    setTimeout(() => f.first.focus(), 50);
  }

  function closeModal(){
    modal.classList.remove("is-open");
    modal.setAttribute("aria-hidden","true");
    document.body.style.overflow = "";
    clearError();
  }

  // Open: any element with .mb-open-consult or [data-mb-open]
  document.addEventListener("click", (e) => {
    const wantsOpen = e.target.closest("[data-mb-open], .mb-open-consult");
    if(!wantsOpen) return;
    e.preventDefault();
    openModal();
  });

  modal.addEventListener("click", (e) => {
    if(e.target.closest("[data-mb-close]")) closeModal();
  });

  document.addEventListener("keydown", (e) => {
    if(e.key === "Escape" && modal.classList.contains("is-open")) closeModal();
  });

  function renderChoices(){
    choicesWrap.innerHTML = "";
    CONSULT_OPTIONS.forEach(opt => {
      const card = document.createElement("div");
      card.className = "mb-choice";
      card.setAttribute("role","button");
      card.setAttribute("tabindex","0");
      card.innerHTML = `<b>${opt.label}</b><p>${opt.desc || ""}</p>`;

      function selectThis(){
        [...choicesWrap.querySelectorAll(".mb-choice")].forEach(el => el.classList.remove("is-selected"));
        card.classList.add("is-selected");
        selectedConsult = opt;
        btnNext3.disabled = false;
      }

      card.addEventListener("click", selectThis);
      card.addEventListener("keydown", (ev) => {
        if(ev.key === "Enter" || ev.key === " "){ ev.preventDefault(); selectThis(); }
      });
      choicesWrap.appendChild(card);
    });
  }
  renderChoices();

  f.zip.addEventListener("input", normalizeZip);

  btnNext1.addEventListener("click", async () => {
    clearError();
    if(!requiredFilledStep1()) return showError("Please complete all fields to continue.");
    if(!isValidEmail(f.email.value)) return showError("Please enter a valid email address.");
    await postWebhook(getPayload({ event:"step_complete", step:1, tags:[TAGS.step1] }));
    setStep(2); f.zip.focus();
  });

  btnBack2.addEventListener("click", () => setStep(1));

  btnNext2.addEventListener("click", async () => {
    clearError(); normalizeZip();
    if(!requiredFilledStep2()) return showError("Please complete all required fields to continue.");
    if(!/^\d{5}$/.test((f.zip.value||"").trim())) return showError("Please enter a valid 5-digit Zip Code.");
    if(!isCaliforniaZip(f.zip.value)){
      await postWebhook(getPayload({ event:"blocked_non_ca", step:2, tags:["non-ca blocked"] }));
      return showError("At the moment, this consult request is for California facilities only. If you're outside CA, please contact us for alternative options.");
    }
    await postWebhook(getPayload({ event:"step_complete", step:2, tags:[TAGS.step2] }));
    selectedConsult = null;
    btnNext3.disabled = true;
    [...choicesWrap.querySelectorAll(".mb-choice")].forEach(el => el.classList.remove("is-selected"));
    setStep(3);
  });

  btnBack3.addEventListener("click", () => setStep(2));

  btnNext3.addEventListener("click", async () => {
    clearError();
    if(!selectedConsult) return showError("Please choose a consult type to continue.");
    const consultTag = selectedConsult.tag || `consult: ${selectedConsult.label}`.toLowerCase();
    await postWebhook(getPayload({
      event: "step_complete", step: 3,
      tags: [TAGS.step3, consultTag],
      consult_choice: { key:selectedConsult.key, label:selectedConsult.label, calendar_url:selectedConsult.calendarUrl }
    }));
    calendarTitleText.textContent = `Schedule: ${selectedConsult.label}`;
    calendarFrame.src = selectedConsult.calendarUrl || "about:blank";
    await postWebhook(getPayload({ event:"step_viewed", step:4, tags:[TAGS.step4, consultTag] }));
    setStep(4);
  });

  btnBack4.addEventListener("click", () => setStep(3));
  btnDone.addEventListener("click", () => closeModal());

  calendarWrap.addEventListener("click", async () => {
    const consultTag = selectedConsult?.tag || (selectedConsult ? `consult: ${selectedConsult.label}`.toLowerCase() : null);
    await postWebhook(getPayload({
      event: "calendar_interaction",
      tags: [TAGS.booked].concat(consultTag ? [consultTag] : [])
    }));
  });
})();
</script>
</body>
</html>
